import{c as mr,l as pr,a as p,m as yr,d as q,j as ve,f as P,t as wt,o as de}from"../chunks/UVeJ-gMM.js";import{a as ot,H as Jt,b1 as $t,h as ie,X as Fe,a5 as Wt,I as dt,l,ak as br,K as _r,Z as Ut,a9 as Ge,e as Pe,J as xr,ae as wr,W as Ot,c as He,b2 as ke,b as St,s as Sr,aA as kr,aR as Cr,ac as Nt,b3 as Mr,b4 as Ir,ap as ge,F as Rt,b5 as Nr,r as Vt,p as qt,b6 as pt,E as Er,b7 as Tr,b8 as Dr,ab as Pr,d as zr,a7 as Ar,b9 as Ur,a0 as Or,ba as Rr,G as Lr,an as jr,bb as Hr,aG as Fr,i as pe,C as Br,bc as Jr,t as ae,x as se,y as h,n as X,A as M,z as v,v as L,aI as Q,bd as Kt,g as Be,aq as f,be as Et,w as $,aH as F,Y as Ce,au as Qe,bf as ze,bg as ut,bh as Xt}from"../chunks/MxV8d662.js";import{s as Y}from"../chunks/aqCmBoA5.js";import{l as re,p as K,s as Z,i as J,c as Tt,b as Yt,a as $r,d as Wr}from"../chunks/Bgi1K6S-.js";import{b as kt,c as ce,d as fe,a as Gt,s as Vr,r as Qt}from"../chunks/DdWOYZiN.js";import{i as Ze}from"../chunks/CpM8Vk1r.js";import{B as qr}from"../chunks/PLzr5LpK.js";import{d as Kr,g as Ct,w as Zt,a as Xr,o as Yr}from"../chunks/C-vtwvhq.js";function Gr(r,e){return e}function Qr(r,e,t){for(var a=[],n=e.length,i,s=e.length,o=0;o<n;o++){let y=e[o];qt(y,()=>{if(i){if(i.pending.delete(y),i.done.add(y),i.pending.size===0){var w=r.outrogroups;Mt(Nt(i.done)),w.delete(i),w.size===0&&(r.outrogroups=null)}}else s-=1},!1)}if(s===0){var c=a.length===0&&t!==null;if(c){var m=t,u=m.parentNode;Pr(u),u.append(m),r.items.clear()}Mt(e,!c)}else i={pending:new Set(e),done:new Set},(r.outrogroups??=new Set).add(i)}function Mt(r,e=!0){for(var t=0;t<r.length;t++)zr(r[t],e)}var Lt;function Ee(r,e,t,a,n,i=null){var s=r,o=new Map,c=(e&$t)!==0;if(c){var m=r;s=ie?Fe(Wt(m)):m.appendChild(ot())}ie&&dt();var u=null,y=kr(()=>{var S=t();return Cr(S)?S:S==null?[]:Nt(S)}),w,C=!0;function k(){d.fallback=u,Zr(d,w,s,e,a),u!==null&&(w.length===0?(u.f&ke)===0?Vt(u):(u.f^=ke,Ye(u,null,s)):qt(u,()=>{u=null}))}var _=Jt(()=>{w=l(y);var S=w.length;let g=!1;if(ie){var E=br(s)===_r;E!==(S===0)&&(s=Ut(),Fe(s),Ge(!1),g=!0)}for(var R=new Set,z=He,b=Sr(),D=0;D<S;D+=1){ie&&Pe.nodeType===xr&&Pe.data===wr&&(s=Pe,g=!0,Ge(!1));var U=w[D],T=a(U,D),A=C?null:o.get(T);A?(A.v&&Ot(A.v,U),A.i&&Ot(A.i,D),b&&z.skipped_effects.delete(A.e)):(A=ea(o,C?s:Lt??=ot(),U,T,D,n,e,t),C||(A.e.f|=ke),o.set(T,A)),R.add(T)}if(S===0&&i&&!u&&(C?u=St(()=>i(s)):(u=St(()=>i(Lt??=ot())),u.f|=ke)),ie&&S>0&&Fe(Ut()),!C)if(b){for(const[x,O]of o)R.has(x)||z.skipped_effects.add(O.e);z.oncommit(k),z.ondiscard(()=>{})}else k();g&&Ge(!0),l(y)}),d={effect:_,items:o,outrogroups:null,fallback:u};C=!1,ie&&(s=Pe)}function Xe(r){for(;r!==null&&(r.f&Tr)===0;)r=r.next;return r}function Zr(r,e,t,a,n){var i=(a&Dr)!==0,s=e.length,o=r.items,c=Xe(r.effect.first),m,u=null,y,w=[],C=[],k,_,d,S;if(i)for(S=0;S<s;S+=1)k=e[S],_=n(k,S),d=o.get(_).e,(d.f&ke)===0&&(d.nodes?.a?.measure(),(y??=new Set).add(d));for(S=0;S<s;S+=1){if(k=e[S],_=n(k,S),d=o.get(_).e,r.outrogroups!==null)for(const A of r.outrogroups)A.pending.delete(d),A.done.delete(d);if((d.f&ke)!==0)if(d.f^=ke,d===c)Ye(d,null,t);else{var g=u?u.next:c;d===r.effect.last&&(r.effect.last=d.prev),d.prev&&(d.prev.next=d.next),d.next&&(d.next.prev=d.prev),Ne(r,u,d),Ne(r,d,g),Ye(d,g,t),u=d,w=[],C=[],c=Xe(u.next);continue}if((d.f&pt)!==0&&(Vt(d),i&&(d.nodes?.a?.unfix(),(y??=new Set).delete(d))),d!==c){if(m!==void 0&&m.has(d)){if(w.length<C.length){var E=C[0],R;u=E.prev;var z=w[0],b=w[w.length-1];for(R=0;R<w.length;R+=1)Ye(w[R],E,t);for(R=0;R<C.length;R+=1)m.delete(C[R]);Ne(r,z.prev,b.next),Ne(r,u,z),Ne(r,b,E),c=E,u=b,S-=1,w=[],C=[]}else m.delete(d),Ye(d,c,t),Ne(r,d.prev,d.next),Ne(r,d,u===null?r.effect.first:u.next),Ne(r,u,d),u=d;continue}for(w=[],C=[];c!==null&&c!==d;)(m??=new Set).add(c),C.push(c),c=Xe(c.next);if(c===null)continue}(d.f&ke)===0&&w.push(d),u=d,c=Xe(d.next)}if(r.outrogroups!==null){for(const A of r.outrogroups)A.pending.size===0&&(Mt(Nt(A.done)),r.outrogroups?.delete(A));r.outrogroups.size===0&&(r.outrogroups=null)}if(c!==null||m!==void 0){var D=[];if(m!==void 0)for(d of m)(d.f&pt)===0&&D.push(d);for(;c!==null;)(c.f&pt)===0&&c!==r.fallback&&D.push(c),c=Xe(c.next);var U=D.length;if(U>0){var T=(a&$t)!==0&&s===0?t:null;if(i){for(S=0;S<U;S+=1)D[S].nodes?.a?.measure();for(S=0;S<U;S+=1)D[S].nodes?.a?.fix()}Qr(r,D,T)}}i&&Er(()=>{if(y!==void 0)for(d of y)d.nodes?.a?.apply()})}function ea(r,e,t,a,n,i,s,o){var c=(s&Mr)!==0?(s&Ir)===0?ge(t,!1,!1):Rt(t):null,m=(s&Nr)!==0?Rt(n):null;return{v:c,i:m,e:St(()=>(i(e,c??t,m??n,o),()=>{r.delete(a)}))}}function Ye(r,e,t){if(r.nodes)for(var a=r.nodes.start,n=r.nodes.end,i=e&&(e.f&ke)===0?e.nodes.start:t;a!==null;){var s=Ar(a);if(i.before(a),a===n)return;a=s}}function Ne(r,e,t){e===null?r.effect.first=t:e.next=t,t===null?r.effect.last=e:t.prev=e}function ee(r,e,t,a,n){ie&&dt();var i=e.$$slots?.[t],s=!1;i===!0&&(i=e.children,s=!0),i===void 0?n!==null&&n(r):i(r,s?()=>a:a)}function ta(r,e,t,a,n,i){let s=ie;ie&&dt();var o=null;ie&&Pe.nodeType===Ur&&(o=Pe,dt());var c=ie?Pe:r,m=new qr(c,!1);Jt(()=>{const u=e()||null;var y=Rr;if(u===null){m.ensure(null,null);return}return m.ensure(u,w=>{if(u){if(o=ie?o:document.createElementNS(y,u),mr(o,o),a){ie&&pr(u)&&o.append(document.createComment(""));var C=ie?Wt(o):o.appendChild(ot());ie&&(C===null?Ge(!1):Fe(C)),a(o,C)}Lr.nodes.end=o,w.before(o)}ie&&Fe(w)}),()=>{}},Or),jr(()=>{}),s&&(Ge(!0),Fe(c))}function et(r,e,t=e){var a=new WeakSet;Hr(r,"input",async n=>{var i=n?r.defaultValue:r.value;if(i=yt(r)?bt(i):i,t(i),He!==null&&a.add(He),await Fr(),i!==(i=e())){var s=r.selectionStart,o=r.selectionEnd,c=r.value.length;if(r.value=i??"",o!==null){var m=r.value.length;s===o&&o===c&&m>c?(r.selectionStart=m,r.selectionEnd=m):(r.selectionStart=s,r.selectionEnd=Math.min(o,m))}}}),(ie&&r.defaultValue!==r.value||pe(e)==null&&r.value)&&(t(yt(r)?bt(r.value):r.value),He!==null&&a.add(He)),Br(()=>{var n=e();if(r===document.activeElement){var i=Jr??He;if(a.has(i))return}yt(r)&&n===bt(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function yt(r){var e=r.type;return e==="number"||e==="range"}function bt(r){return r===""?null:+r}const ra={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};const aa=r=>{for(const e in r)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const jt=(...r)=>r.filter((e,t,a)=>!!e&&e.trim()!==""&&a.indexOf(e)===t).join(" ").trim();var sa=yr("<svg><!><!></svg>");function oe(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]),a=re(t,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);ae(e,!1);let n=K(e,"name",8,void 0),i=K(e,"color",8,"currentColor"),s=K(e,"size",8,24),o=K(e,"strokeWidth",8,2),c=K(e,"absoluteStrokeWidth",8,!1),m=K(e,"iconNode",24,()=>[]);Ze();var u=sa();kt(u,(C,k,_)=>({...ra,...C,...a,width:s(),height:s(),stroke:i(),"stroke-width":k,class:_}),[()=>aa(a)?void 0:{"aria-hidden":"true"},()=>(X(c()),X(o()),X(s()),pe(()=>c()?Number(o())*24/Number(s()):o())),()=>(X(jt),X(n()),X(t),pe(()=>jt("lucide-icon","lucide",n()?`lucide-${n()}`:"",t.class)))]);var y=h(u);Ee(y,1,m,Gr,(C,k)=>{var _=Q(()=>Kt(l(k),2));let d=()=>l(_)[0],S=()=>l(_)[1];var g=q(),E=L(g);ta(E,d,!0,(R,z)=>{kt(R,()=>({...S()}))}),p(C,g)});var w=M(y);ee(w,e,"default",{},null),v(u),p(r,u),se()}function er(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["path",{d:"M20 6 9 17l-5-5"}]];oe(r,Z({name:"check"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function tr(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["circle",{cx:"12",cy:"12",r:"10"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16"}]];oe(r,Z({name:"circle-alert"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function na(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["path",{d:"M11 14h10"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v1.344"}],["path",{d:"m17 18 4-4-4-4"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 1.793-1.113"}],["rect",{x:"8",y:"2",width:"8",height:"4",rx:"1"}]];oe(r,Z({name:"clipboard-paste"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function ia(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];oe(r,Z({name:"copy"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function oa(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5"}],["path",{d:"M10 9H8"}],["path",{d:"M16 13H8"}],["path",{d:"M16 17H8"}]];oe(r,Z({name:"file-text"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function la(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2"}]];oe(r,Z({name:"folder-open"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function ca(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z"}],["path",{d:"M12 22V12"}],["polyline",{points:"3.29 7 12 12 20.71 7"}],["path",{d:"m7.5 4.27 9 5.15"}]];oe(r,Z({name:"package"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function da(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1"}]];oe(r,Z({name:"pause"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function ua(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}]];oe(r,Z({name:"pen"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function fa(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"}]];oe(r,Z({name:"play"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function rr(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["path",{d:"M5 12h14"}],["path",{d:"M12 5v14"}]];oe(r,Z({name:"plus"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function va(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}]];oe(r,Z({name:"rotate-ccw"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function ga(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}]];oe(r,Z({name:"square"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function Dt(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["path",{d:"M10 11v6"}],["path",{d:"M14 11v6"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}],["path",{d:"M3 6h18"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}]];oe(r,Z({name:"trash-2"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function ha(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}],["circle",{cx:"9",cy:"7",r:"4"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11"}]];oe(r,Z({name:"user-plus"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function Ht(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}],["circle",{cx:"12",cy:"7",r:"4"}]];oe(r,Z({name:"user"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}function Je(r,e){const t=re(e,["children","$$slots","$$events","$$legacy"]);const a=[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]];oe(r,Z({name:"x"},()=>t,{get iconNode(){return a},children:(n,i)=>{var s=q(),o=L(s);ee(o,e,"default",{},null),p(n,s)},$$slots:{default:!0}}))}var ma=P('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50"><div class="w-full max-w-2xl rounded-lg bg-white shadow-xl"><div class="flex items-center justify-between border-b border-gray-200 px-4 py-3"><h2 class="text-lg font-medium text-gray-900"> </h2> <button class="rounded p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600"><!></button></div> <div class="p-4"><textarea placeholder="Enter a detailed description of this scenario..." class="h-64 w-full resize-none rounded-lg border border-gray-300 p-3 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"></textarea></div> <div class="flex justify-end gap-2 border-t border-gray-200 px-4 py-3"><button class="rounded px-4 py-2 text-sm text-gray-600 hover:bg-gray-100">Cancel</button> <button class="rounded bg-blue-500 px-4 py-2 text-sm text-white hover:bg-blue-600">Save</button></div></div></div>');function pa(r,e){ae(e,!0);let t=F("");Be(()=>{f(t,e.description,!0)});function a(){e.onSave(l(t))}function n(){e.onClose()}function i(g){g.key==="Escape"&&e.onClose()}var s=ma();s.__click=n;var o=h(s);o.__click=g=>g.stopPropagation(),o.__keydown=i;var c=h(o),m=h(c),u=h(m);v(m);var y=M(m,2);y.__click=function(...g){e.onClose?.apply(this,g)};var w=h(y);Je(w,{size:20}),v(y),v(c);var C=M(c,2),k=h(C);Et(k),v(C);var _=M(C,2),d=h(_);d.__click=function(...g){e.onClose?.apply(this,g)};var S=M(d,2);S.__click=a,v(_),v(o),v(s),$(()=>Y(u,`${e.title??""} - Description`)),et(k,()=>l(t),g=>f(t,g)),p(r,s),se()}ve(["click","keydown"]);var ya=P('<div class="flex items-center gap-2"><button class="flex items-center gap-1 rounded px-2 py-1 text-xs text-gray-600 hover:bg-gray-200 disabled:opacity-50" title="Reset to original"><!> Reset</button> <button class="flex items-center gap-1 rounded bg-blue-500 px-2 py-1 text-xs text-white hover:bg-blue-600 disabled:opacity-50" title="Save changes (Cmd/Ctrl+S)"><!> Save</button></div>'),ba=P('<div class="absolute bottom-0 left-0 right-0 flex items-center gap-2 bg-red-500/90 px-3 py-2 text-xs text-white"><!> </div>'),_a=P('<div class="relative flex-1"><textarea class="h-full w-full resize-none bg-gray-900 p-3 font-mono text-sm text-gray-100 focus:outline-none" spellcheck="false"></textarea> <!></div>'),xa=P('<div class="flex flex-1 items-center justify-center text-sm text-gray-400">Select a message to edit its JSON payload</div>'),wa=P('<div class="flex h-full flex-col border-t border-gray-200"><div class="flex items-center justify-between border-b border-gray-200 bg-gray-50 px-3 py-2"><span class="text-sm font-medium text-gray-700"><!></span> <!></div> <!></div>');function Sa(r,e){ae(e,!0);let t=F(""),a=F(null),n=F(null);Be(()=>{e.payload?(f(t,JSON.stringify(e.payload,null,2),!0),f(n,structuredClone(e.payload),!0),f(a,null)):(f(t,""),f(n,null),f(a,null))});function i(){try{const b=JSON.parse(l(t));return typeof b.className!="string"||typeof b.topic!="string"||typeof b.attributes!="object"||typeof b.message!="object"?(f(a,"Invalid structure: requires className, topic, attributes, and message"),null):(f(a,null),b)}catch(b){return f(a,b instanceof Error?b.message:"Invalid JSON",!0),null}}function s(){i()}function o(){const b=i();b&&e.onSave(b)}function c(){l(n)&&(f(t,JSON.stringify(l(n),null,2),!0),f(a,null))}function m(b){(b.metaKey||b.ctrlKey)&&b.key==="s"&&(b.preventDefault(),o())}const u=Q(()=>e.payload&&l(t)!==JSON.stringify(e.payload,null,2));var y=wa(),w=h(y),C=h(w),k=h(C);{var _=b=>{var D=wt();$(()=>Y(D,`Editing: ${e.payload.className??""}`)),p(b,D)},d=b=>{var D=wt("JSON Editor");p(b,D)};J(k,b=>{e.payload?b(_):b(d,!1)})}v(C);var S=M(C,2);{var g=b=>{var D=ya(),U=h(D);U.__click=c;var T=h(U);va(T,{size:12}),Ce(),v(U);var A=M(U,2);A.__click=o;var x=h(A);er(x,{size:12}),Ce(),v(A),v(D),$(()=>{U.disabled=!l(u),A.disabled=!!l(a)||!l(u)}),p(b,D)};J(S,b=>{e.payload&&b(g)})}v(w);var E=M(w,2);{var R=b=>{var D=_a(),U=h(D);Et(U),U.__input=s,U.__keydown=m;var T=M(U,2);{var A=x=>{var O=ba(),B=h(O);tr(B,{size:14});var I=M(B);v(O),$(()=>Y(I,` ${l(a)??""}`)),p(x,O)};J(T,x=>{l(a)&&x(A)})}v(D),et(U,()=>l(t),x=>f(t,x)),p(b,D)},z=b=>{var D=xa();p(b,D)};J(E,b=>{e.payload?b(R):b(z,!1)})}v(y),p(r,y),se()}ve(["click","input","keydown"]);const Te="http://localhost:8080",ka=`${Te}/publish`;async function Ca(r){try{const e=await fetch(ka,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});let t,a;if(e.ok)try{const n=await e.text();n&&(a=JSON.parse(n))}catch{}else try{t=await e.text()}catch{}return{ok:e.ok,status:e.status,statusText:e.statusText,errorBody:t,responseBody:a}}catch(e){return{ok:!1,status:0,statusText:e instanceof Error?e.message:"Network error"}}}async function Ma(){const r=await fetch(`${Te}/message-samples`);if(!r.ok)throw new Error(`Failed to fetch message samples: ${r.statusText}`);return r.json()}async function Ia(r){const e=await fetch(`${Te}/message-samples`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok)throw new Error(`Failed to save message sample: ${e.statusText}`);return e.json()}async function Na(r){const e=await fetch(`${Te}/message-samples/${r}`,{method:"DELETE"});if(!e.ok)throw new Error(`Failed to delete message sample: ${e.statusText}`)}async function Ea(){const r=await fetch(`${Te}/users`);if(!r.ok)throw new Error(`Failed to fetch users: ${r.statusText}`);return r.json()}async function Ta(r){const e=await fetch(`${Te}/users/${encodeURIComponent(r)}/scenarios`);if(!e.ok)throw new Error(`Failed to fetch scenarios: ${e.statusText}`);return e.json()}async function Da(r,e){const t=await fetch(`${Te}/users/${encodeURIComponent(r)}/scenarios`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Failed to save scenario: ${t.statusText}`);return t.json()}async function Pa(r,e){const t=await fetch(`${Te}/users/${encodeURIComponent(r)}/scenarios/${e}`,{method:"DELETE"});if(!t.ok)throw new Error(`Failed to delete scenario: ${t.statusText}`)}class za{#e=F(Qe([]));get samples(){return l(this.#e)}set samples(e){f(this.#e,e,!0)}#t=F(!0);get isLoading(){return l(this.#t)}set isLoading(e){f(this.#t,e,!0)}#r=F(null);get error(){return l(this.#r)}set error(e){f(this.#r,e,!0)}constructor(){typeof window<"u"&&this.init()}async init(){try{this.isLoading=!0,this.error=null,this.samples=await Ma()}catch(e){this.error=e instanceof Error?e.message:"Failed to load message samples",console.error("Failed to load message samples:",e)}finally{this.isLoading=!1}}async upsertSample(e){const a=this.samples.findIndex(n=>n.messageId===e.messageId)===-1;a?this.samples=[...this.samples,e]:this.samples=this.samples.map(n=>n.messageId===e.messageId?e:n);try{const n=await Ia(e);return this.samples=this.samples.map(i=>i.messageId===n.messageId?n:i),n}catch(n){throw a&&(this.samples=this.samples.filter(i=>i.messageId!==e.messageId)),n}}async reload(){await this.init()}async deleteSample(e){const t=this.samples.find(a=>a.messageId===e);this.samples=this.samples.filter(a=>a.messageId!==e);try{await Na(e)}catch(a){throw t&&(this.samples=[...this.samples,t]),a}}}const Se=new za;function Aa(r,e,t,a){var n,i,s=!1,o=t.length>=2,c=(k,_,d)=>{if(n=_,o&&(i=k),!s){let S=e(k,_,d);if(e.length<2)_(S);else return S}s=!1},m=Kr(r,c,a),u=!Array.isArray(r);function y(k){var _=t(k,i);u?(s=!0,r.set(_)):_.forEach((d,S)=>{s=!0,r[S].set(d)}),s=!1}var w=!1;function C(k){var _,d,S,g;if(w){g=k(Ct(m)),n(g);return}var E=m.subscribe(R=>{w?_?d=!0:_=!0:S=R});g=k(S),w=!0,n(g),E(),w=!1,d&&(g=Ct(m)),_&&y(g)}return{subscribe:m.subscribe,set(k){C(()=>k)},update:C}}const Ua=20,Ae=Zt([]),Pt=Zt(null),lt=new Map,Ft=r=>{if(lt.has(r))return;const e=setTimeout(()=>{lt.delete(r),sr(r)},1e3);lt.set(r,e)},Oa=r=>{const e=lt.get(r);e&&clearTimeout(e)};function ar(r){r.id&&Oa(r.id),Ae.update(e=>e.map(t=>t.id===r.id?{...t,...r}:t))}function Ra(r){Ae.update(e=>[r,...e].slice(0,Ua))}function La(r){Ct(Ae).find(e=>e.id===r.id)?ar(r):Ra(r)}function ja(r){Ae.update(e=>(r?Ft(r):e.forEach(t=>{Ft(t.id)}),e.map(t=>t.id===r||r===void 0?{...t,visible:!1}:t)))}function sr(r){Ae.update(e=>r===void 0?[]:e.filter(t=>t.id!==r))}function Ha(r){Pt.set(r)}function Fa(r){let e;Pt.update(t=>(e=r-(t||0),null)),Ae.update(t=>t.map(a=>({...a,pauseDuration:a.pauseDuration+e})))}const Ba={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3};function Ja(r={}){return{toasts:Aa(Ae,t=>t.map(a=>({...r,...r[a.type],...a,duration:a.duration||r[a.type]?.duration||r?.duration||Ba[a.type],style:[r.style,r[a.type]?.style,a.style].join(";")})),t=>t),pausedAt:Pt}}const $a=r=>typeof r=="function",Bt=(r,e)=>$a(r)?r(e):r,Wa=(()=>{let r=0;return()=>(r+=1,r.toString())})(),It=(()=>{let r;return()=>{if(r===void 0&&typeof window<"u"){const e=matchMedia("(prefers-reduced-motion: reduce)");r=!e||e.matches}return r}})(),Va=(r,e="blank",t)=>({createdAt:Date.now(),visible:!0,type:e,ariaProps:{role:"status","aria-live":"polite"},message:r,pauseDuration:0,...t,id:t?.id||Wa()}),tt=r=>(e,t)=>{const a=Va(e,r,t);return La(a),a.id},H=(r,e)=>tt("blank")(r,e);H.error=tt("error");H.success=tt("success");H.loading=tt("loading");H.custom=tt("custom");H.dismiss=r=>{ja(r)};H.remove=r=>sr(r);H.promise=(r,e,t)=>{const a=H.loading(e.loading,{...t,...t?.loading});return r.then(n=>(H.success(Bt(e.success,n),{id:a,...t,...t?.success}),n)).catch(n=>{H.error(Bt(e.error,n),{id:a,...t,...t?.error})}),r};function qa(r,e,t){const{reverseOrder:a,gutter:n=8,defaultPosition:i}=t||{},s=e.filter(u=>(u.position||i)===(r.position||i)&&u.height),o=s.findIndex(u=>u.id===r.id),c=s.filter((u,y)=>y<o&&u.visible).length;return s.filter(u=>u.visible).slice(...a?[c+1]:[0,c]).reduce((u,y)=>u+(y.height||0)+n,0)}const Ka={startPause(){Ha(Date.now())},endPause(){Fa(Date.now())},updateHeight:(r,e)=>{ar({id:r,height:e})},calculateOffset:qa};function Xa(r){const{toasts:e,pausedAt:t}=Ja(r),a=new Map;let n;const i=[t.subscribe(s=>{if(s){for(const[,o]of a)clearTimeout(o);a.clear()}n=s}),e.subscribe(s=>{if(n)return;const o=Date.now();for(const c of s){if(a.has(c.id)||c.duration===1/0)continue;const m=(c.duration||0)+c.pauseDuration-(o-c.createdAt);if(m<0)return c.visible&&H.dismiss(c.id),null;a.set(c.id,setTimeout(()=>H.dismiss(c.id),m))}})];return Xr(()=>{for(const s of i)s()}),{toasts:e,handlers:Ka}}var Ya=P('<div class="svelte-1rwl7ho"></div>');function Ga(r,e){let t=K(e,"primary",8,"#61d345"),a=K(e,"secondary",8,"#fff");var n=Ya();let i;$(()=>i=ce(n,"",i,{"--primary":t(),"--secondary":a()})),p(r,n)}var Qa=P('<div class="svelte-tdvg6p"></div>');function Za(r,e){let t=K(e,"primary",8,"#ff4b4b"),a=K(e,"secondary",8,"#fff");var n=Qa();let i;$(()=>i=ce(n,"",i,{"--primary":t(),"--secondary":a()})),p(r,n)}var es=P('<div class="svelte-1xo581e"></div>');function ts(r,e){let t=K(e,"primary",8,"#616161"),a=K(e,"secondary",8,"#e0e0e0");var n=es();let i;$(()=>i=ce(n,"",i,{"--primary":t(),"--secondary":a()})),p(r,n)}var rs=P('<div class="animated svelte-qnoxya"> </div>'),as=P('<div class="status svelte-qnoxya"><!></div>'),ss=P('<div class="indicator svelte-qnoxya"><!> <!></div>');function _t(r,e){ae(e,!1);const t=ge(),a=ge(),n=ge();let i=K(e,"toast",8);ze(()=>(l(t),l(a),l(n),X(i())),()=>{(u=>{f(t,u.type),f(a,u.icon),f(n,u.iconTheme)})(i())}),ut();var s=q(),o=L(s);{var c=u=>{var y=rs(),w=h(y,!0);v(y),$(()=>Y(w,l(a))),p(u,y)},m=u=>{var y=q(),w=L(y);{var C=_=>{var d=q(),S=L(d);Tt(S,()=>l(a),(g,E)=>{E(g,{})}),p(_,d)},k=_=>{var d=q(),S=L(d);{var g=E=>{var R=ss(),z=h(R);ts(z,Z(()=>l(n)));var b=M(z,2);{var D=U=>{var T=as(),A=h(T);{var x=B=>{Za(B,Z(()=>l(n)))},O=B=>{Ga(B,Z(()=>l(n)))};J(A,B=>{l(t)==="error"?B(x):B(O,!1)})}v(T),p(U,T)};J(b,U=>{l(t)!=="loading"&&U(D)})}v(R),p(E,R)};J(S,E=>{l(t)!=="blank"&&E(g)},!0)}p(_,d)};J(w,_=>{typeof l(a)<"u"?_(C):_(k,!1)},!0)}p(u,y)};J(o,u=>{typeof l(a)=="string"?u(c):u(m,!1)})}p(r,s),se()}var ns=P("<div><!></div>");function ct(r,e){ae(e,!1);let t=K(e,"toast",8);Ze();var a=ns();kt(a,()=>({class:"message",...t().ariaProps}),void 0,void 0,void 0,"svelte-tb6am6");var n=h(a);{var i=o=>{var c=wt();$(()=>Y(c,(X(t()),pe(()=>t().message)))),p(o,c)},s=o=>{var c=q(),m=L(c);Tt(m,()=>t().message,(u,y)=>{y(u,{get toast(){return t()}})}),p(o,c)};J(n,o=>{X(t()),pe(()=>typeof t().message=="string")?o(i):o(s,!1)})}v(a),p(r,a),se()}var is=P("<!> <!>",1),os=P("<div><!></div>");function ls(r,e){ae(e,!1);let t=K(e,"toast",8),a=K(e,"position",24,()=>{}),n=K(e,"style",8,""),i=K(e,"Component",24,()=>{}),s=ge(),o=ge();ze(()=>(X(t()),X(a()),It),()=>{const C=(t().position||a()||"top-center").includes("top");f(s,C?1:-1);const[k,_]=It()?["fadeIn","fadeOut"]:["enter","exit"];f(o,t().visible?k:_)}),ut(),Ze();var c=os();let m;var u=h(c);{var y=C=>{var k=q(),_=L(k);Tt(_,i,(d,S)=>{S(d,{$$slots:{icon:(g,E)=>{_t(g,{get toast(){return t()},slot:"icon"})},message:(g,E)=>{ct(g,{get toast(){return t()},slot:"message"})}}})}),p(C,k)},w=C=>{var k=q(),_=L(k);ee(_,e,"default",{get ToastIcon(){return _t},get ToastMessage(){return ct},get toast(){return t()}},d=>{var S=is(),g=L(S);_t(g,{get toast(){return t()}});var E=M(g,2);ct(E,{get toast(){return t()}}),p(d,S)}),p(C,k)};J(u,C=>{i()?C(y):C(w,!1)})}v(c),$(()=>{fe(c,1,`base ${X(t()),l(o),pe(()=>t().height?l(o):"transparent")??""} ${X(t()),pe(()=>t().className||"")??""}`,"svelte-1g0yga0"),m=ce(c,`${n()??""}; ${X(t()),pe(()=>t().style)??""}`,m,{"--factor":l(s)})}),p(r,c),se()}var cs=P("<div><!></div>");function ds(r,e){ae(e,!1);const t=ge(),a=ge(),n=ge(),i=ge();let s=K(e,"toast",8),o=K(e,"setHeight",8),c=ge();Yr(()=>{o()(l(c).getBoundingClientRect().height)}),ze(()=>X(s()),()=>{f(t,s().position?.includes("top")?0:null)}),ze(()=>X(s()),()=>{f(a,s().position?.includes("bottom")?0:null)}),ze(()=>X(s()),()=>{f(n,s().position?.includes("top")?1:-1)}),ze(()=>X(s()),()=>{f(i,s().position?.includes("center")&&"center"||(s().position?.includes("right")||s().position?.includes("end"))&&"flex-end"||null)}),ut(),Ze();var m=cs();let u,y;var w=h(m);{var C=_=>{ct(_,{get toast(){return s()}})},k=_=>{var d=q(),S=L(d);ee(S,e,"default",{get toast(){return s()}},g=>{ls(g,{get toast(){return s()},get position(){return X(s()),pe(()=>s().position)}})}),p(_,d)};J(w,_=>{X(s()),pe(()=>s().type==="custom")?_(C):_(k,!1)})}v(m),Yt(m,_=>f(c,_),()=>l(c)),$(_=>{u=fe(m,1,"wrapper svelte-fsxqeu",null,u,_),y=ce(m,"",y,{"--factor":l(n),"--offset":(X(s()),pe(()=>s().offset)),top:l(t),bottom:l(a),"justify-content":l(i)})},[()=>({active:s().visible,transition:!It()})]),p(r,m),se()}var us=P('<div role="alert"></div>');function fs(r,e){ae(e,!1);const t=()=>Wr(y,"$toasts",a),[a,n]=$r();let i=K(e,"reverseOrder",8,!1),s=K(e,"position",8,"top-center"),o=K(e,"toastOptions",24,()=>{}),c=K(e,"gutter",8,8),m=K(e,"containerStyle",24,()=>{}),u=K(e,"containerClassName",24,()=>{});const{toasts:y,handlers:w}=Xa(o());let C=ge();ze(()=>(t(),X(s()),X(i()),X(c())),()=>{f(C,t().map(_=>({..._,position:_.position||s(),offset:w.calculateOffset(_,t(),{reverseOrder:i(),gutter:c(),defaultPosition:s()})})))}),ut(),Ze();var k=us();Ee(k,5,()=>l(C),_=>_.id,(_,d)=>{ds(_,{get toast(){return l(d)},setHeight:S=>w.updateHeight(l(d).id,S)})}),v(k),$(()=>{fe(k,1,`toaster ${(u()||"")??""}`,"svelte-yoigw"),ce(k,m())}),de("mouseenter",k,function(..._){w.startPause?.apply(this,_)}),de("mouseleave",k,function(..._){w.endPause?.apply(this,_)}),p(r,k),se(),n()}var vs=P('<div draggable="true" class="flex cursor-grab items-center gap-2 rounded-lg border border-gray-200 bg-white p-3 shadow-sm transition-shadow hover:shadow-md active:cursor-grabbing"><div><!></div> <div class="min-w-0 flex-1"><div class="truncate text-sm font-medium text-gray-900"> </div> <div class="truncate text-xs text-gray-500"> </div></div></div>'),gs=P('<div class="py-4 text-center text-sm text-gray-400">Loading templates...</div>'),hs=P('<div class="py-4 text-center text-sm text-red-500"> </div>'),ms=P('<div class="py-4 text-center text-sm text-gray-400">No message templates yet.<br/>Click "Add Message Type" to create one.</div>'),ps=P('<div class="flex h-full flex-col bg-gray-50 p-3"><h2 class="mb-3 text-sm font-semibold text-gray-700">Message Templates</h2> <button><!> </button> <div class="flex flex-col gap-2"></div> <!></div>');function ys(r,e){ae(e,!0);let t=F(!1);const a=["bg-blue-500","bg-green-500","bg-amber-500","bg-purple-500","bg-rose-500","bg-cyan-500"];function n(g){const E=g.split("").reduce((R,z)=>R+z.charCodeAt(0),0);return a[E%a.length]}function i(g,E){g.dataTransfer&&(g.dataTransfer.effectAllowed="copy",g.dataTransfer.setData("application/json",JSON.stringify(E)),g.dataTransfer.setData("text/plain",E.className))}function s(g){e.onEditSample(g)}function o(g){g.preventDefault(),g.dataTransfer&&(g.dataTransfer.dropEffect="copy"),f(t,!0)}function c(){f(t,!1)}async function m(g){g.preventDefault(),f(t,!1);const E=g.dataTransfer?.files?.[0];if(!E)return;let R;try{R=await E.text()}catch{H.error("Could not read file");return}let z;try{z=JSON.parse(R)}catch{H.error("Invalid JSON");return}if(typeof z!="object"||z===null||Array.isArray(z)){H.error("JSON must be an object");return}const b=z;for(const T of["className","topic","attributes","message"])if(!(T in b)){H.error(`Missing required field: ${T}`);return}if(typeof b.className!="string"||typeof b.topic!="string"){H.error("className and topic must be strings");return}if(typeof b.attributes!="object"||b.attributes===null||Array.isArray(b.attributes)){H.error("attributes must be an object");return}if(typeof b.message!="object"||b.message===null||Array.isArray(b.message)){H.error("message must be an object");return}const D=Se.samples.find(T=>T.className===b.className),U={messageId:D?.messageId??crypto.randomUUID(),className:b.className,topic:b.topic,attributes:b.attributes,message:b.message};try{await Se.upsertSample(U),H.success(D?`${U.className} was updated`:`${U.className} was created`)}catch{H.error("Failed to save message sample")}}var u=ps(),y=M(h(u),2);y.__click=function(...g){e.onCreateSample?.apply(this,g)};var w=h(y);rr(w,{size:16});var C=M(w);v(y);var k=M(y,2);Ee(k,21,()=>Se.samples,g=>g.messageId,(g,E)=>{const R=Q(()=>n(l(E).className));var z=vs();z.__dblclick=()=>s(l(E));var b=h(z),D=h(b);ca(D,{size:16}),v(b);var U=M(b,2),T=h(U),A=h(T,!0);v(T);var x=M(T,2),O=h(x,!0);v(x),v(U),v(z),$(()=>{Gt(z,"title",l(E).className),fe(b,1,`${l(R)??""} flex h-8 w-8 items-center justify-center rounded text-white`),Y(A,l(E).className),Y(O,l(E).topic)}),de("dragstart",z,B=>i(B,l(E))),p(g,z)}),v(k);var _=M(k,2);{var d=g=>{var E=gs();p(g,E)},S=g=>{var E=q(),R=L(E);{var z=D=>{var U=hs(),T=h(U,!0);v(U),$(()=>Y(T,Se.error)),p(D,U)},b=D=>{var U=q(),T=L(U);{var A=x=>{var O=ms();p(x,O)};J(T,x=>{Se.samples.length===0&&x(A)},!0)}p(D,U)};J(R,D=>{Se.error?D(z):D(b,!1)},!0)}p(g,E)};J(_,g=>{Se.isLoading?g(d):g(S,!1)})}v(u),$(()=>{fe(y,1,`mb-3 flex items-center justify-center gap-2 rounded-lg border-2 px-3 py-2 text-sm transition-colors ${l(t)?"border-solid border-blue-500 bg-blue-50 text-blue-600":"border-dashed border-gray-300 bg-white text-gray-600 hover:border-blue-400 hover:bg-blue-50 hover:text-blue-600"}`),Y(C,` ${l(t)?"Drop JSON file here":"Add Message Type"}`)}),de("dragover",y,o),de("dragleave",y,c),de("drop",y,m),p(r,u),se()}ve(["click","dblclick"]);var bs=P('<p class="text-xs text-gray-500"> </p>'),_s=P('<div class="absolute bottom-0 left-0 right-0 flex items-center gap-2 bg-red-500/90 px-3 py-2 text-xs text-white"><!> </div>'),xs=P('<button class="flex items-center gap-1 rounded px-4 py-2 text-sm text-red-600 hover:bg-red-50"><!> Delete</button> <div class="flex-1"></div>',1),ws=P('<div class="flex-1"></div>'),Ss=P('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50"><div class="flex max-h-[90vh] w-full max-w-2xl flex-col overflow-hidden rounded-lg bg-white shadow-xl"><div class="flex items-center justify-between border-b border-gray-200 px-4 py-3"><div><h2 class="text-lg font-medium text-gray-900"> </h2> <!></div> <button class="rounded p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600"><!></button></div> <div class="relative flex-1 overflow-hidden"><textarea class="h-96 w-full resize-none bg-gray-900 p-4 font-mono text-sm text-gray-100 focus:outline-none" spellcheck="false"></textarea> <!></div> <div class="flex gap-2 border-t border-gray-200 px-4 py-3"><!> <button class="rounded px-4 py-2 text-sm text-gray-600 hover:bg-gray-100">Cancel</button> <button class="rounded bg-blue-500 px-4 py-2 text-sm text-white hover:bg-blue-600 disabled:opacity-50">Save</button></div></div></div>');function ks(r,e){ae(e,!0);const t=`{
  "className": "ExampleMessage",
  "topic": "orders-topic",
  "attributes": {
    "traceId": "123-456-7890"
  },
  "message": {
    "name": "stuff"
  }
}`;let a=F(""),n=F(null);Be(()=>{if(e.sample){const{className:I,topic:V,attributes:G,message:ne}=e.sample;f(a,JSON.stringify({className:I,topic:V,attributes:G,message:ne},null,2),!0)}else f(a,t);f(n,null)});function i(){try{const I=JSON.parse(l(a));return typeof I.className!="string"||typeof I.topic!="string"||typeof I.attributes!="object"||I.attributes===null||typeof I.message!="object"||I.message===null?(f(n,"Invalid structure: requires className, topic, attributes, and message"),null):(f(n,null),I)}catch(I){return f(n,I instanceof Error?I.message:"Invalid JSON",!0),null}}function s(){i()}function o(){const I=i();if(I){const V={...I,messageId:e.sample?.messageId??String(Date.now())};e.onSave(V)}}function c(){e.onClose()}function m(I){I.key==="Escape"&&e.onClose(),(I.metaKey||I.ctrlKey)&&I.key==="s"&&(I.preventDefault(),o())}var u=Ss();u.__click=c;var y=h(u);y.__click=I=>I.stopPropagation(),y.__keydown=m;var w=h(y),C=h(w),k=h(C),_=h(k,!0);v(k);var d=M(k,2);{var S=I=>{var V=bs(),G=h(V);v(V),$(()=>Y(G,`ID: ${e.sample.messageId??""}`)),p(I,V)};J(d,I=>{e.sample&&I(S)})}v(C);var g=M(C,2);g.__click=function(...I){e.onClose?.apply(this,I)};var E=h(g);Je(E,{size:20}),v(g),v(w);var R=M(w,2),z=h(R);Et(z),z.__input=s,z.__keydown=m;var b=M(z,2);{var D=I=>{var V=_s(),G=h(V);tr(G,{size:14});var ne=M(G);v(V),$(()=>Y(ne,` ${l(n)??""}`)),p(I,V)};J(b,I=>{l(n)&&I(D)})}v(R);var U=M(R,2),T=h(U);{var A=I=>{var V=xs(),G=L(V);G.__click=()=>e.onDelete(e.sample.messageId);var ne=h(G);Dt(ne,{size:14}),Ce(),v(G),Ce(2),p(I,V)},x=I=>{var V=ws();p(I,V)};J(T,I=>{e.sample&&e.onDelete?I(A):I(x,!1)})}var O=M(T,2);O.__click=function(...I){e.onClose?.apply(this,I)};var B=M(O,2);B.__click=o,v(U),v(y),v(u),$(()=>{Y(_,e.sample?"Edit Message Sample":"Create Message Sample"),B.disabled=!!l(n)}),et(z,()=>l(a),I=>f(a,I)),p(r,u),se()}ve(["click","keydown","input"]);var Cs=P('<button class="flex h-8 w-8 items-center justify-center rounded bg-amber-500 text-white hover:bg-amber-600" title="Pause (Space)"><!></button>'),Ms=P('<button class="flex h-8 w-8 items-center justify-center rounded bg-green-500 text-white hover:bg-green-600 disabled:opacity-50" title="Play (Space)"><!></button>'),Is=P('<div class="flex items-center gap-3"><!> <button class="flex h-8 w-8 items-center justify-center rounded bg-gray-500 text-white hover:bg-gray-600 disabled:opacity-50" title="Stop"><!></button> <div class="flex items-center gap-2 text-sm"></div></div>');function Ns(r,e){ae(e,!0);var t=Is(),a=h(t);{var n=c=>{var m=Cs();m.__click=function(...y){e.onPause?.apply(this,y)};var u=h(m);da(u,{size:16}),v(m),p(c,m)},i=c=>{var m=Ms();m.__click=function(...y){e.onPlay?.apply(this,y)};var u=h(m);fa(u,{size:16}),v(m),$(()=>m.disabled=!e.hasMessages),p(c,m)};J(a,c=>{e.state.status==="playing"?c(n):c(i,!1)})}var s=M(a,2);s.__click=function(...c){e.onStop?.apply(this,c)};var o=h(s);ga(o,{size:16}),v(s),Ce(2),v(t),$(()=>s.disabled=e.state.status==="idle"),p(r,t),se()}ve(["click"]);var Es=P('<div class="flex-shrink-0"><div></div> <div class="h-[calc(100%-6px)]"><!></div></div>');function Ts(r,e){ae(e,!0);let t=K(e,"minHeight",3,128),a=K(e,"maxHeightRatio",3,.8),n=K(e,"initialHeightRatio",3,.5),i=F(0),s=F(!1),o=F(!1);Be(()=>{!l(o)&&typeof window<"u"&&(f(i,window.innerHeight*n()),f(o,!0))});function c(_){_.preventDefault(),f(s,!0);const d=_.clientY,S=l(i);function g(R){const z=d-R.clientY,b=window.innerHeight*a();f(i,Math.min(b,Math.max(t(),S+z)),!0)}function E(){f(s,!1),window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",E)}window.addEventListener("mousemove",g),window.addEventListener("mouseup",E)}function m(){return l(s)}var u={getIsResizing:m},y=Es(),w=h(y);w.__mousedown=c;var C=M(w,2),k=h(C);return Vr(k,()=>e.children),v(C),v(y),$(()=>{ce(y,`height: ${l(i)??""}px;`),fe(w,1,`h-1.5 cursor-ns-resize border-t border-gray-200 bg-gray-100 hover:bg-blue-200 transition-colors
      ${l(s)?"bg-blue-300":""}`)}),p(r,y),se(u)}ve(["mousedown"]);var Ds=P('<div class="group flex items-center justify-between px-3 py-2 hover:bg-gray-100"><button> <span class="ml-1 text-xs text-gray-400"> </span></button> <button class="rounded p-1 text-gray-400 opacity-0 hover:bg-red-50 hover:text-red-500 group-hover:opacity-100" title="Delete scenario"><!></button></div>'),Ps=P('<div class="absolute right-0 top-full z-50 mt-1 w-64 rounded-lg border border-gray-200 bg-white py-1 shadow-lg"><button class="flex w-full items-center gap-2 px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100"><!> New Scenario</button> <button class="flex w-full items-center gap-2 px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100"><!> Paste Scenario</button> <div class="my-1 border-t border-gray-100"></div> <!></div> <button class="fixed inset-0 z-40" aria-label="Close menu"></button>',1),zs=P('<div class="relative"><button class="flex items-center gap-1 rounded px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100"><!> Scenarios</button> <!></div>');function As(r,e){ae(e,!0);let t=F(!1);function a(){f(t,!l(t))}function n(){e.onNew(),f(t,!1)}function i(k){e.onSelect(k),f(t,!1)}function s(){e.onPaste(),f(t,!1)}function o(){f(t,!1)}var c={close:o},m=zs(),u=h(m);u.__click=a;var y=h(u);la(y,{size:14}),Ce(),v(u);var w=M(u,2);{var C=k=>{var _=Ps(),d=L(_),S=h(d);S.__click=n;var g=h(S);rr(g,{size:14}),Ce(),v(S);var E=M(S,2);E.__click=s;var R=h(E);na(R,{size:14}),Ce(),v(E);var z=M(E,4);Ee(z,17,()=>e.scenarios,D=>D.id,(D,U)=>{var T=Ds(),A=h(T);A.__click=()=>i(l(U).id);var x=h(A),O=M(x),B=h(O);v(O),v(A);var I=M(A,2);I.__click=()=>e.onDelete(l(U).id);var V=h(I);Dt(V,{size:14}),v(I),v(T),$(()=>{fe(A,1,`flex-1 text-left text-sm
              ${l(U).id===e.currentScenarioId?"font-medium text-blue-600":"text-gray-700"}`),Y(x,`${l(U).name??""} `),Y(B,`(${l(U).messages.length??""})`)}),p(D,T)}),v(d);var b=M(d,2);b.__click=()=>f(t,!1),p(k,_)};J(w,k=>{l(t)&&k(C)})}return v(m),p(r,m),se(c)}ve(["click"]);var Us=P('<div class="max-h-32 overflow-auto rounded bg-gray-100 p-2 text-xs font-mono text-gray-700"> </div>'),Os=P('<div class="absolute top-full left-0 z-[200] mt-2 w-72 rounded-lg border border-red-200 bg-white p-3 shadow-lg"><div class="mb-2 flex items-center justify-between"><span class="font-medium text-red-600"> </span> <button class="rounded p-0.5 text-gray-400 hover:bg-gray-100 hover:text-gray-600"><!></button></div> <div class="mb-2 text-sm text-gray-600"> </div> <!></div>');function Rs(r,e){ae(e,!0);var t=Os();t.__click=w=>w.stopPropagation();var a=h(t),n=h(a),i=h(n);v(n);var s=M(n,2);s.__click=function(...w){e.onClose?.apply(this,w)};var o=h(s);Je(o,{size:14}),v(s),v(a);var c=M(a,2),m=h(c,!0);v(c);var u=M(c,2);{var y=w=>{var C=Us(),k=h(C,!0);v(C),$(()=>Y(k,e.result.errorBody)),p(w,C)};J(u,w=>{e.result.errorBody&&w(y)})}v(t),$(()=>{Y(i,`Error ${e.result.statusCode??""}`),Y(m,e.result.statusText)}),p(r,t),se()}ve(["click"]);var Ls=P('<div class="absolute top-full left-0 z-[200] mt-2 w-80 rounded-lg border border-green-200 bg-white p-3 shadow-lg"><div class="mb-2 flex items-center justify-between"><span class="font-medium text-green-600">Response</span> <button class="rounded p-0.5 text-gray-400 hover:bg-gray-100 hover:text-gray-600"><!></button></div> <div class="max-h-48 overflow-auto rounded bg-gray-100 p-2 text-xs font-mono text-black whitespace-pre"> </div></div>');function js(r,e){ae(e,!0);const t=Q(()=>e.result.responseBody!==void 0?JSON.stringify(e.result.responseBody,null,2):"No response body");var a=Ls();a.__click=m=>m.stopPropagation();var n=h(a),i=M(h(n),2);i.__click=function(...m){e.onClose?.apply(this,m)};var s=h(i);Je(s,{size:14}),v(i),v(n);var o=M(n,2),c=h(o,!0);v(o),v(a),$(()=>Y(c,l(t))),p(r,a),se()}ve(["click"]);var Hs=P("<button></button> <!>",1),Fs=P('<div draggable="true" role="button" tabindex="0"><span class="truncate"> </span> <button class="ml-auto shrink-0 rounded p-0.5 hover:bg-white/20" title="Delete message"><!></button> <!></div>');function Bs(r,e){ae(e,!0);const t=["bg-blue-500","bg-green-500","bg-amber-500","bg-purple-500","bg-rose-500","bg-cyan-500"];function a(T){const A=T.split("").reduce((x,O)=>x+O.charCodeAt(0),0);return t[A%t.length]}let n=F(!1),i=F(0),s=F(0),o=F(!1);function c(T){if(!T.dataTransfer)return;f(n,!0),f(i,T.clientX,!0),f(s,e.message.column,!0),T.dataTransfer.effectAllowed="move",T.dataTransfer.setData("text/plain",e.message.id);const A=document.createElement("div");A.style.opacity="0",document.body.appendChild(A),T.dataTransfer.setDragImage(A,0,0),setTimeout(()=>A.remove(),0)}function m(T){if(!l(n)||T.clientX===0)return;const A=T.clientX-l(i),x=Math.round(A/e.columnWidth),O=Math.min(20,Math.max(1,l(s)+x));e.onColumnChange(O)}function u(){f(n,!1)}function y(){e.onSelect()}function w(T){T.stopPropagation(),e.onDelete()}function C(T){T.stopPropagation(),e.result&&f(o,!l(o))}function k(){f(o,!1)}const _=Q(()=>a(e.message.payload.className)),d=Q(()=>(e.message.column-1)*e.columnWidth+4),S=Q(()=>e.columnWidth-8);var g=Fs();de("click",Xt,()=>{l(o)&&f(o,!1)}),g.__dblclick=y,g.__click=function(...T){e.onSelect?.apply(this,T)},g.__keydown=T=>T.key==="Enter"&&e.onSelect();var E=h(g),R=h(E,!0);v(E);var z=M(E,2);z.__click=w;var b=h(z);Je(b,{size:12}),v(z);var D=M(z,2);{var U=T=>{var A=Hs(),x=L(A);x.__click=C;var O=M(x,2);{var B=I=>{var V=q(),G=L(V);{var ne=he=>{Rs(he,{get result(){return e.result},onClose:k})},xe=he=>{js(he,{get result(){return e.result},onClose:k})};J(G,he=>{e.result.status==="error"?he(ne):he(xe,!1)})}p(I,V)};J(O,I=>{l(o)&&I(B)})}$(()=>{fe(x,1,`absolute -bottom-1 left-1/2 -translate-x-1/2 h-3 w-3 rounded-full border-2 border-white shadow-sm cursor-pointer
        ${e.result.status==="success"?"bg-green-500":"bg-red-500"}`),Gt(x,"title",e.result.status==="success"?"Click to view response":`Error: ${e.result.statusCode} ${e.result.statusText}`)}),p(T,A)};J(D,T=>{e.result&&T(U)})}v(g),$(()=>{fe(g,1,`absolute top-1 flex h-8 cursor-grab items-center gap-1 rounded px-2 text-xs text-white shadow transition-all select-none
    ${l(_)??""}
    ${e.isSelected?"ring-2 ring-white ring-offset-2":""}
    ${l(n)?"cursor-grabbing opacity-75":""}`),ce(g,`left: ${l(d)??""}px; width: ${l(S)??""}px;`),Y(R,e.message.payload.className)}),de("dragstart",g,c),de("drag",g,m),de("dragend",g,u),p(r,g),se()}ve(["dblclick","click","keydown"]);var Js=P('<div class="pointer-events-none absolute top-0 z-20"><div class="absolute inset-y-0 left-0 w-0.5 bg-red-500"></div> <div class="absolute -top-1 left-0 h-3 w-3 -translate-x-1/2 rotate-45 bg-red-500"></div></div>');function $s(r,e){const t=Q(()=>e.labelWidth+(e.currentColumn-1)*e.columnWidth);var a=q(),n=L(a);{var i=s=>{var o=Js();$(()=>ce(o,`left: ${l(t)??""}px; width: ${e.columnWidth??""}px; height: ${e.height??""}px;`)),p(s,o)};J(n,s=>{e.currentColumn>0&&s(i)})}p(r,a)}var Ws=P('<div class="flex shrink-0 items-center justify-center border-r border-gray-200 text-xs font-medium text-gray-500"> </div>'),Vs=P('<div class="flex h-32 items-center justify-center text-sm text-gray-400">Drag messages here to build your scenario</div>'),qs=P('<div><div class="sticky left-0 z-5 flex h-full shrink-0 items-center bg-white/90 px-2 text-xs font-medium text-gray-600 border-r border-gray-200"><span class="truncate"> </span></div> <div class="lane-content relative"></div></div>'),Ks=P('<div class="flex h-full flex-col"><div class="flex items-center justify-between border-b border-gray-200 bg-gray-50 px-3 py-2"><span class="text-sm font-medium text-gray-700">Timeline</span></div> <div role="application" tabindex="0"><div class="relative"><div class="sticky top-0 z-10 flex h-6 border-b border-gray-200 bg-gray-100"><div class="shrink-0 border-r border-gray-200"></div> <!></div> <div class="relative"><!> <!></div></div></div></div>');function Xs(r,e){ae(e,!0);const t=132,a=240,n=20;let i=F(void 0),s=F(!1);const o=Q(()=>{const x={};for(const O of e.messages){const B=O.payload.className;x[B]||(x[B]=[]),x[B].push(O)}return Object.entries(x).sort((O,B)=>O[0].localeCompare(B[0]))}),c=Q(()=>Array.from({length:n},(x,O)=>O+1)),m=Q(()=>n*t);function u(x){x.preventDefault(),x.dataTransfer&&(x.dataTransfer.dropEffect="copy"),f(s,!0)}function y(){f(s,!1)}function w(x){if(x.preventDefault(),f(s,!1),!x.dataTransfer||!l(i))return;const O=x.dataTransfer.getData("application/json");if(O)try{const B=JSON.parse(O),I=l(i).getBoundingClientRect(),V=l(i).scrollLeft,ne=x.clientX-I.left+V-a,xe=Math.min(n,Math.max(1,Math.ceil(ne/t)));e.onAddMessage(B,xe)}catch{console.error("Failed to parse dropped data")}}function C(x){(x.target===l(i)||x.target.classList.contains("lane")||x.target.classList.contains("lane-content"))&&e.onSelectMessage(null)}function k(x){const O=e.messages.find(B=>B.id===x);return O?O.column<=e.completedColumns:!1}var _=Ks(),d=M(h(_),2);d.__click=C;var S=h(d);ce(S,`width: ${a+l(m)}px; min-height: 100%;`);var g=h(S),E=h(g);ce(E,"width: 240px;");var R=M(E,2);Ee(R,16,()=>l(c),x=>x,(x,O)=>{var B=Ws();ce(B,"width: 132px;");var I=h(B,!0);v(B),$(()=>Y(I,O)),p(x,B)}),v(g);var z=M(g,2),b=h(z);{var D=x=>{var O=Vs();ce(O,`width: ${a+l(m)}px;`),p(x,O)},U=x=>{var O=q(),B=L(O);Ee(B,19,()=>l(o),([I,V])=>I,(I,V,G)=>{var ne=Q(()=>Kt(l(V),2));let xe=()=>l(ne)[0],he=()=>l(ne)[1];var De=qs();let Ue;var Me=h(De);ce(Me,"width: 240px;");var Oe=h(Me),rt=h(Oe,!0);v(Oe),v(Me);var $e=M(Me,2);ce($e,`width: ${l(m)??""}px;`),Ee($e,21,he,We=>We.id,(We,ye)=>{{let ft=Q(()=>e.selectedMessageId===l(ye).id),vt=Q(()=>k(l(ye).id));Bs(We,{get message(){return l(ye)},columnWidth:t,get isSelected(){return l(ft)},get isSent(){return l(vt)},get result(){return e.messageResults[l(ye).id]},onSelect:()=>e.onSelectMessage(l(ye).id),onDelete:()=>e.onDeleteMessage(l(ye).id),onColumnChange:at=>e.onUpdateColumn(l(ye).id,at)})}}),v($e),v(De),$(()=>{Ue=fe(De,1,"lane relative flex h-10 border-b border-gray-100",null,Ue,{"bg-gray-50":l(G)%2===1}),Y(rt,xe())}),p(I,De)}),p(x,O)};J(b,x=>{l(o).length===0?x(D):x(U,!1)})}var T=M(b,2);{var A=x=>{{let O=Q(()=>l(o).length*40+24);$s(x,{get currentColumn(){return e.currentColumn},columnWidth:t,labelWidth:a,get height(){return l(O)}})}};J(T,x=>{(e.isPlaying||e.currentColumn>0)&&x(A)})}v(z),v(S),v(d),Yt(d,x=>f(i,x),()=>l(i)),v(_),$(()=>fe(d,1,`relative flex-1 overflow-auto bg-white
			${l(s)?"bg-blue-50":""}`)),de("dragover",d,u),de("dragleave",d,y),de("drop",d,w),p(r,_),se()}ve(["click"]);var Ys=P("<button><!> </button>"),Gs=P('<div class="my-1 border-t border-gray-100"></div> <!>',1),Qs=P('<div class="absolute left-0 top-full z-50 mt-1 w-64 rounded-lg border border-gray-200 bg-white py-1 shadow-lg"><div class="px-3 py-2"><div class="flex gap-2"><input type="text" placeholder="New user ID..." class="flex-1 rounded border border-gray-300 px-2 py-1.5 text-sm focus:border-blue-500 focus:outline-none"/> <button class="flex items-center gap-1 rounded bg-blue-500 px-2 py-1.5 text-sm text-white hover:bg-blue-600 disabled:opacity-50"><!></button></div></div> <!></div> <button class="fixed inset-0 z-40" aria-label="Close menu"></button>',1),Zs=P('<div class="relative"><button class="flex items-center gap-1.5 rounded px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100"><!> </button> <!></div>');function en(r,e){ae(e,!0);let t=F(!1),a=F("");function n(){f(t,!l(t))}function i(d){e.onSelect(d),f(t,!1)}function s(){const d=l(a).trim();d&&!e.users.includes(d)&&(e.onAdd(d),f(a,""),f(t,!1))}function o(d){d.key==="Enter"&&s()}function c(){f(t,!1)}var m={close:c},u=Zs(),y=h(u);y.__click=n;var w=h(y);Ht(w,{size:14});var C=M(w);v(y);var k=M(y,2);{var _=d=>{var S=Qs(),g=L(S),E=h(g),R=h(E),z=h(R);Qt(z),z.__keydown=o;var b=M(z,2);b.__click=s;var D=h(b);ha(D,{size:14}),v(b),v(R),v(E);var U=M(E,2);{var T=x=>{var O=Gs(),B=M(L(O),2);Ee(B,16,()=>e.users,I=>I,(I,V)=>{var G=Ys();G.__click=()=>i(V);var ne=h(G);Ht(ne,{size:14});var xe=M(ne);v(G),$(()=>{fe(G,1,`flex w-full items-center gap-2 px-3 py-2 text-left text-sm hover:bg-gray-100
              ${V===e.currentUserId?"font-medium text-blue-600":"text-gray-700"}`),Y(xe,` ${V??""}`)}),p(I,G)}),p(x,O)};J(U,x=>{e.users.length>0&&x(T)})}v(g);var A=M(g,2);A.__click=()=>f(t,!1),$(x=>b.disabled=x,[()=>!l(a).trim()||e.users.includes(l(a).trim())]),et(z,()=>l(a),x=>f(a,x)),p(d,S)};J(k,d=>{l(t)&&d(_)})}return v(u),$(()=>Y(C,` ${e.currentUserId??"Select User"??""}`)),p(r,u),se(m)}ve(["click","keydown"]);class tn{#e=F("idle");get status(){return l(this.#e)}set status(e){f(this.#e,e,!0)}#t=F(0);get currentColumn(){return l(this.#t)}set currentColumn(e){f(this.#t,e,!0)}#r=F(0);get completedColumns(){return l(this.#r)}set completedColumns(e){f(this.#r,e,!0)}#a=F(Qe([]));get errors(){return l(this.#a)}set errors(e){f(this.#a,e,!0)}#s=F(Qe({}));get messageResults(){return l(this.#s)}set messageResults(e){f(this.#s,e,!0)}abortController=null;get state(){return{status:this.status,currentColumn:this.currentColumn,completedColumns:this.completedColumns,errors:this.errors,messageResults:this.messageResults}}async play(e){if(this.status!=="playing"){if(this.status==="paused"){this.resume(e);return}this.status="playing",this.currentColumn=0,this.completedColumns=0,this.errors=[],this.messageResults={},this.abortController=new AbortController,await this.executeColumns(e,1)}}async resume(e){this.status="playing",this.abortController=new AbortController,await this.executeColumns(e,this.completedColumns+1)}pause(){this.status==="playing"&&(this.status="paused",this.abortController?.abort())}stop(){this.status="idle",this.currentColumn=0,this.completedColumns=0,this.errors=[],this.messageResults={},this.abortController?.abort()}async executeColumns(e,t){for(let a=t;a<=20;a++){if(this.abortController?.signal.aborted)return;const n=e.filter(o=>o.column===a);if(n.length===0)continue;this.currentColumn=a;const i=await Promise.all(n.map(async o=>{const c=await Ca(o.payload);return{message:o,response:c}}));if(this.abortController?.signal.aborted)return;let s=!1;for(const{message:o,response:c}of i)c.ok?this.messageResults={...this.messageResults,[o.id]:{status:"success",responseBody:c.responseBody}}:(this.messageResults={...this.messageResults,[o.id]:{status:"error",statusCode:c.status,statusText:c.statusText,errorBody:c.errorBody}},s=!0);if(s){this.status="error";const o=i.find(c=>!c.response.ok);o&&(console.log({failedMsg:o}),this.errors=i.filter(c=>!c.response.ok).map(c=>`Failed to send ${c.message.payload.className}`));return}if(this.completedColumns=a,await new Promise(o=>{const c=setTimeout(o,750);this.abortController?.signal.addEventListener("abort",()=>{clearTimeout(c),o()})}),this.abortController?.signal.aborted)return}this.status==="playing"&&(this.status="idle")}}const le=new tn;function it(){return crypto.randomUUID()}class rn{#e=F(Qe([]));get scenarios(){return l(this.#e)}set scenarios(e){f(this.#e,e,!0)}#t=F(null);get currentScenarioId(){return l(this.#t)}set currentScenarioId(e){f(this.#t,e,!0)}#r=F(null);get selectedMessageId(){return l(this.#r)}set selectedMessageId(e){f(this.#r,e,!0)}#a=F(!1);get isLoading(){return l(this.#a)}set isLoading(e){f(this.#a,e,!0)}#s=F(null);get error(){return l(this.#s)}set error(e){f(this.#s,e,!0)}#n=F(null);get userId(){return l(this.#n)}set userId(e){f(this.#n,e,!0)}#i=Q(()=>this.scenarios.find(e=>e.id===this.currentScenarioId)??null);get currentScenario(){return l(this.#i)}set currentScenario(e){f(this.#i,e)}#o=Q(()=>this.currentScenario?.messages.find(e=>e.id===this.selectedMessageId)??null);get selectedMessage(){return l(this.#o)}set selectedMessage(e){f(this.#o,e)}async loadForUser(e){this.userId=e,this.isLoading=!0,this.error=null;try{const t=await Ta(e);this.scenarios=t.map(a=>({...a,description:a.description??""})),this.currentScenarioId=this.scenarios[0]?.id??null,this.selectedMessageId=null}catch(t){this.error=t instanceof Error?t.message:"Failed to load scenarios",console.error("Failed to load scenarios:",t)}finally{this.isLoading=!1}}clearForNoUser(){this.userId=null,this.scenarios=[],this.currentScenarioId=null,this.selectedMessageId=null,this.isLoading=!1,this.error=null}async persistScenario(e){if(!this.userId)throw new Error("No user selected");try{await Da(this.userId,e)}catch(t){throw console.error("Failed to save scenario:",t),t}}async importScenario(e){if(!this.userId)throw new Error("No user selected");const t={id:it(),name:e.name,description:e.description??"",messages:e.messages.map(a=>({id:it(),column:a.column,payload:structuredClone(a.payload)}))};return this.scenarios=[...this.scenarios,t],this.currentScenarioId=t.id,this.selectedMessageId=null,await this.persistScenario(t),t.id}async createScenario(e){if(!this.userId)throw new Error("No user selected");const t={id:it(),name:e,description:"",messages:[]};return this.scenarios=[...this.scenarios,t],this.currentScenarioId=t.id,this.selectedMessageId=null,await this.persistScenario(t),t.id}async deleteScenario(e){this.userId&&(this.scenarios=this.scenarios.filter(t=>t.id!==e),this.currentScenarioId===e&&(this.currentScenarioId=this.scenarios[0]?.id??null,this.selectedMessageId=null),await Pa(this.userId,e))}async renameScenario(e,t){const a=this.scenarios.find(i=>i.id===e);if(!a)return;const n={...a,name:t};this.scenarios=this.scenarios.map(i=>i.id===e?n:i),await this.persistScenario(n)}async updateDescription(e,t){const a=this.scenarios.find(i=>i.id===e);if(!a)return;const n={...a,description:t};this.scenarios=this.scenarios.map(i=>i.id===e?n:i),await this.persistScenario(n)}selectScenario(e){this.currentScenarioId=e,this.selectedMessageId=null}async addMessage(e,t=1){if(!this.currentScenarioId)return"";const a={id:it(),column:Math.min(20,Math.max(1,t)),payload:structuredClone(e)},n=this.scenarios.find(s=>s.id===this.currentScenarioId);if(!n)return"";const i={...n,messages:[...n.messages,a]};return this.scenarios=this.scenarios.map(s=>s.id===this.currentScenarioId?i:s),this.selectedMessageId=a.id,await this.persistScenario(i),a.id}async removeMessage(e){if(!this.currentScenarioId)return;const t=this.scenarios.find(n=>n.id===this.currentScenarioId);if(!t)return;const a={...t,messages:t.messages.filter(n=>n.id!==e)};this.scenarios=this.scenarios.map(n=>n.id===this.currentScenarioId?a:n),this.selectedMessageId===e&&(this.selectedMessageId=null),await this.persistScenario(a)}async updateMessage(e,t){if(!this.currentScenarioId)return;const a=this.scenarios.find(i=>i.id===this.currentScenarioId);if(!a)return;const n={...a,messages:a.messages.map(i=>i.id===e?{...i,payload:structuredClone(t)}:i)};this.scenarios=this.scenarios.map(i=>i.id===this.currentScenarioId?n:i),await this.persistScenario(n)}async updateColumn(e,t){if(!this.currentScenarioId)return;const a=this.scenarios.find(i=>i.id===this.currentScenarioId);if(!a)return;const n={...a,messages:a.messages.map(i=>i.id===e?{...i,column:Math.min(20,Math.max(1,t))}:i)};this.scenarios=this.scenarios.map(i=>i.id===this.currentScenarioId?n:i),await this.persistScenario(n)}selectMessage(e){this.selectedMessageId=e}async clearScenario(){if(!this.currentScenarioId)return;const e=this.scenarios.find(a=>a.id===this.currentScenarioId);if(!e)return;const t={...e,messages:[]};this.scenarios=this.scenarios.map(a=>a.id===this.currentScenarioId?t:a),this.selectedMessageId=null,await this.persistScenario(t)}}const j=new rn,xt="reggie-selected-user";class an{#e=F(Qe([]));get users(){return l(this.#e)}set users(e){f(this.#e,e,!0)}#t=F(null);get currentUserId(){return l(this.#t)}set currentUserId(e){f(this.#t,e,!0)}#r=F(!0);get isLoading(){return l(this.#r)}set isLoading(e){f(this.#r,e,!0)}#a=F(null);get error(){return l(this.#a)}set error(e){f(this.#a,e,!0)}constructor(){typeof window<"u"&&this.init()}async init(){try{this.isLoading=!0,this.error=null,this.users=await Ea();const e=localStorage.getItem(xt);e&&this.users.includes(e)&&(this.currentUserId=e)}catch(e){this.error=e instanceof Error?e.message:"Failed to load users",console.error("Failed to load users:",e)}finally{this.isLoading=!1}}selectUser(e){this.currentUserId=e,e?localStorage.setItem(xt,e):localStorage.removeItem(xt)}addUser(e){this.users.includes(e)||(this.users=[...this.users,e]),this.selectUser(e)}}const me=new an;var sn=P('<input type="text" class="w-40 rounded border border-gray-300 px-2 py-1 text-sm"/> <button class="rounded p-1 text-green-600 hover:bg-green-50"><!></button> <button class="rounded p-1 text-gray-400 hover:bg-gray-100"><!></button>',1),nn=P('<span class="font-medium text-gray-700"> </span> <button class="rounded p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600" title="Rename scenario"><!></button> <button title="Edit description"><!></button> <button class="rounded p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600" title="Copy scenario to clipboard"><!></button>',1),on=P('<span class="text-sm text-gray-500">No scenarios</span>'),ln=P('<div class="h-6 w-px bg-gray-200"></div> <!> <div class="flex items-center gap-2"><!></div>',1),cn=P('<button class="flex items-center gap-1 rounded px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100 disabled:opacity-50" title="Clear all messages"><!> Clear</button> <!>',1),dn=P('<div class="flex flex-1 items-center justify-center text-gray-500">Select a user to view scenarios</div>'),un=P('<div class="flex-1 overflow-hidden"><!></div> <!>',1),fn=P('<!> <div class="flex h-screen flex-col bg-gray-100"><header class="flex items-center justify-between border-b border-gray-200 bg-white px-4 py-2"><div class="flex items-center gap-4"><!> <!></div> <div class="flex items-center gap-2"><!></div></header> <div class="flex flex-1 overflow-hidden"><aside class="w-70 flex-shrink-0 overflow-y-auto border-r border-gray-200 bg-white"><!></aside> <main class="flex flex-1 flex-col overflow-hidden"><!></main></div></div> <!> <!>',1);function xn(r,e){ae(e,!0);let t=F(!1),a=F(""),n=F(!1),i=F(!1),s=F(null);Be(()=>{me.currentUserId?j.loadForUser(me.currentUserId):j.clearForNoUser()});function o(N){me.selectUser(N),le.stop()}function c(N){me.addUser(N),le.stop()}function m(){j.currentScenario&&le.play(j.currentScenario.messages)}function u(){le.pause()}function y(){le.stop()}function w(N,W){j.addMessage(N,W)}function C(N){j.selectMessage(N)}function k(N){j.removeMessage(N)}function _(N,W){j.updateColumn(N,W)}function d(N){j.selectedMessageId&&(j.updateMessage(j.selectedMessageId,N),H.success("Message updated"))}function S(){const N=`Scenario ${j.scenarios.length+1}`;j.createScenario(N),H.success("New scenario created")}function g(N){j.selectScenario(N),le.stop()}async function E(N){try{await j.deleteScenario(N),H.success("Scenario deleted")}catch(W){H.error(W instanceof Error?W.message:"Failed to delete scenario")}}function R(){j.clearScenario(),H.success("Scenario cleared")}function z(){j.currentScenario&&(f(a,j.currentScenario.name,!0),f(t,!0))}function b(){j.currentScenarioId&&l(a).trim()&&j.renameScenario(j.currentScenarioId,l(a).trim()),f(t,!1)}function D(){f(t,!1)}function U(){j.currentScenario&&f(n,!0)}function T(N){j.currentScenarioId&&(j.updateDescription(j.currentScenarioId,N),H.success("Description saved")),f(n,!1)}function A(){f(n,!1)}async function x(){if(!j.currentScenario||!me.currentUserId)return;const N=JSON.parse(JSON.stringify(j.currentScenario));N.name=`${me.currentUserId} - ${N.name}`,await navigator.clipboard.writeText(JSON.stringify(N,null,2)),H.success("Scenario copied to clipboard")}async function O(){let N;try{N=await navigator.clipboard.readText()}catch{H.error("Could not read clipboard");return}let W;try{W=JSON.parse(N)}catch{H.error("Clipboard does not contain valid JSON");return}if(typeof W!="object"||W===null||Array.isArray(W)){H.error("Invalid scenario format");return}const te=W;if(typeof te.name!="string"||!te.name.trim()){H.error("Invalid scenario: missing name");return}if(!Array.isArray(te.messages)){H.error("Invalid scenario: missing messages");return}for(const ue of te.messages){if(typeof ue!="object"||ue===null){H.error("Invalid scenario: invalid message format");return}const we=ue;if(typeof we.column!="number"||typeof we.payload!="object"||we.payload===null){H.error("Invalid scenario: message missing column or payload");return}}try{const ue=W;await j.importScenario(ue),H.success(`${ue.name} stored`)}catch{H.error("Failed to store scenario")}}function B(N){f(s,N,!0),f(i,!0)}function I(){f(s,null),f(i,!0)}async function V(N){try{const W=l(s)!==null;await Se.upsertSample(N),H.success(W?"Message sample updated":"Message sample created"),f(i,!1),f(s,null)}catch(W){H.error(W instanceof Error?W.message:"Failed to save message sample")}}function G(){f(i,!1),f(s,null)}async function ne(N){try{await Se.deleteSample(N),H.success("Message sample deleted"),f(i,!1),f(s,null)}catch(W){H.error(W instanceof Error?W.message:"Failed to delete message sample")}}function xe(N){N.target instanceof HTMLTextAreaElement||N.target instanceof HTMLInputElement||(N.key===" "&&(N.preventDefault(),le.status==="playing"?u():m()),(N.key==="Delete"||N.key==="Backspace")&&j.selectedMessageId&&k(j.selectedMessageId),N.key==="Escape"&&(j.selectMessage(null),f(n,!1),f(i,!1)))}Be(()=>{le.status==="error"&&le.errors.length&&le.errors.forEach(N=>H.error(N))});var he=fn();de("keydown",Xt,xe);var De=L(he);fs(De,{position:"bottom-right"});var Ue=M(De,2),Me=h(Ue),Oe=h(Me),rt=h(Oe);en(rt,{get users(){return me.users},get currentUserId(){return me.currentUserId},onSelect:o,onAdd:c});var $e=M(rt,2);{var We=N=>{var W=ln(),te=M(L(W),2);{let be=Q(()=>!!j.currentScenario?.messages.length);Ns(te,{get state(){return le.state},get hasMessages(){return l(be)},onPlay:m,onPause:u,onStop:y})}var ue=M(te,2),we=h(ue);{var Ve=be=>{var qe=sn(),Re=L(qe);Qt(Re),Re.__keydown=Ie=>{Ie.key==="Enter"&&b(),Ie.key==="Escape"&&D()};var Le=M(Re,2);Le.__click=b;var ht=h(Le);er(ht,{size:16}),v(Le);var _e=M(Le,2);_e.__click=D;var je=h(_e);Je(je,{size:16}),v(_e),et(Re,()=>l(a),Ie=>f(a,Ie)),p(be,qe)},st=be=>{var qe=q(),Re=L(qe);{var Le=_e=>{var je=nn(),Ie=L(je),fr=h(Ie,!0);v(Ie);var nt=M(Ie,2);nt.__click=z;var vr=h(nt);ua(vr,{size:14}),v(nt);var Ke=M(nt,2);Ke.__click=U;var gr=h(Ke);oa(gr,{size:14}),v(Ke);var mt=M(Ke,2);mt.__click=x;var hr=h(mt);ia(hr,{size:14}),v(mt),$(()=>{Y(fr,j.currentScenario.name),fe(Ke,1,`rounded p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600
                ${j.currentScenario?.description?"text-blue-500":""}`)}),p(_e,je)},ht=_e=>{var je=on();p(_e,je)};J(Re,_e=>{j.currentScenario?_e(Le):_e(ht,!1)},!0)}p(be,qe)};J(we,be=>{l(t)?be(Ve):be(st,!1)})}v(ue),p(N,W)};J($e,N=>{me.currentUserId&&N(We)})}v(Oe);var ye=M(Oe,2),ft=h(ye);{var vt=N=>{var W=cn(),te=L(W);te.__click=R;var ue=h(te);Dt(ue,{size:14}),Ce(),v(te);var we=M(te,2);As(we,{get scenarios(){return j.scenarios},get currentScenarioId(){return j.currentScenarioId},onNew:S,onSelect:g,onDelete:E,onPaste:O}),$(()=>te.disabled=!j.currentScenario?.messages.length),p(N,W)};J(ft,N=>{me.currentUserId&&N(vt)})}v(ye),v(Me);var at=M(Me,2),gt=h(at),nr=h(gt);ys(nr,{onEditSample:B,onCreateSample:I}),v(gt);var zt=M(gt,2),ir=h(zt);{var or=N=>{var W=dn();p(N,W)},lr=N=>{var W=un(),te=L(W),ue=h(te);{let Ve=Q(()=>j.currentScenario?.messages??[]),st=Q(()=>le.status==="playing");Xs(ue,{get messages(){return l(Ve)},get selectedMessageId(){return j.selectedMessageId},get currentColumn(){return le.currentColumn},get completedColumns(){return le.completedColumns},get isPlaying(){return l(st)},get messageResults(){return le.messageResults},onAddMessage:w,onSelectMessage:C,onDeleteMessage:k,onUpdateColumn:_})}v(te);var we=M(te,2);Ts(we,{minHeight:128,maxHeightRatio:.8,initialHeightRatio:.64,children:(Ve,st)=>{{let be=Q(()=>j.selectedMessage?.payload??null);Sa(Ve,{get payload(){return l(be)},onSave:d})}},$$slots:{default:!0}}),p(N,W)};J(ir,N=>{me.currentUserId?N(lr,!1):N(or)})}v(zt),v(at),v(Ue);var At=M(Ue,2);{var cr=N=>{{let W=Q(()=>j.currentScenario?.name??"Scenario"),te=Q(()=>j.currentScenario?.description??"");pa(N,{get title(){return l(W)},get description(){return l(te)},onSave:T,onClose:A})}};J(At,N=>{l(n)&&N(cr)})}var dr=M(At,2);{var ur=N=>{ks(N,{get sample(){return l(s)},onSave:V,onDelete:ne,onClose:G})};J(dr,N=>{l(i)&&N(ur)})}p(r,he),se()}ve(["keydown","click"]);export{xn as component};
